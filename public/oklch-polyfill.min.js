!function(){"use strict";!function(){if(!function(){if("undefined"==typeof CSS||!CSS.supports)return!0;try{return!CSS.supports("color","oklch(0.7 0.15 250)")||!CSS.supports("color","oklch(from red l c h)")}catch(t){return!0}}())return;class t{static oklchToRgb(t,e,r){const{L:s,a:o,b:l}=this.oklchToOklab(t,e,r),{r:c,g:i,b:a}=this.oklabToLinearRgb(s,o,l);return this.linearRgbToSrgb(c,i,a)}static oklchToOklab(t,e,r){const s=r*Math.PI/180;return{L:t,a:e*Math.cos(s),b:e*Math.sin(s)}}static oklabToLinearRgb(t,e,r){const s=t+.3963377774*e+.2158037573*r,o=t-.1055613458*e-.0638541728*r,l=t-.0894841775*e-1.291485548*r,c=s*s*s,i=o*o*o,a=l*l*l;return{r:4.0767416621*c-3.3077115913*i+.2309699292*a,g:-1.2684380046*c+2.6097574011*i-.3413193965*a,b:-.0041960863*c-.7034186147*i+1.707614701*a}}static linearRgbToSrgb(t,e,r){const s=t=>{const e=Math.abs(t);return e>.0031308?Math.sign(t)*(1.055*Math.pow(e,1/2.4)-.055):12.92*t};return{r:Math.max(0,Math.min(255,Math.round(255*s(t)))),g:Math.max(0,Math.min(255,Math.round(255*s(e)))),b:Math.max(0,Math.min(255,Math.round(255*s(r))))}}static parseOklchToRgb(t){const e=t.match(/oklch\(\s*([^)]+)\s*\)/);if(!e)return null;const r=e[1].split(/\s+/).map((t=>parseFloat(t.trim())));if(3!==r.length)return null;const[s,o,l]=r,{r:c,g:i,b:a}=this.oklchToRgb(s,o,l);return`rgb(${c}, ${i}, ${a})`}static applyRelativeTransform(t,e,r,s,o,l){const c=(t,e,r,s)=>{if("l"===t)return e;if("c"===t)return r;if("h"===t)return s;if(t.includes("calc(")){let o=t.replace("calc(","").replace(")","");o=o.replace(/\bl\b/g,e),o=o.replace(/\bc\b/g,r),o=o.replace(/\bh\b/g,s);try{return Function(`"use strict"; return (${o})`)()}catch(o){return"l"===t?e:"c"===t?r:s}}return parseFloat(t)||0};return{l:c(s,t,e,r),c:c(o,t,e,r),h:c(l,t,e,r)}}}class e{static extractOklchProperties(){const t=new Map;getComputedStyle(document.documentElement);for(const e of document.styleSheets)try{this.parseStyleSheet(e,t)}catch(t){}return t}static parseStyleSheet(t,e){if(t.cssRules)for(const r of t.cssRules)r.type===CSSRule.STYLE_RULE?this.parseStyleRule(r,e):r.type===CSSRule.MEDIA_RULE&&this.parseStyleSheet(r,e)}static parseStyleRule(t,e){for(let r=0;r<t.style.length;r++){const s=t.style[r],o=t.style.getPropertyValue(s);s.startsWith("--")&&this.containsOklch(o)&&e.set(s,o.trim())}}static containsOklch(t){return t.includes("oklch(")||t.includes("color-mix(in oklch")}static parseRelativeOklch(t){const e=t.match(/oklch\(\s*from\s+(var\([^)]+\)|oklch\([^)]+\))\s+([^)]+)\s*\)/);if(!e)return null;const[,r,s]=e,o=s.trim().split(/\s+/);return 3!==o.length?null:{from:r.trim(),lightness:o[0],chroma:o[1],hue:o[2]}}static parseSimpleOklch(t){const e=t.match(/oklch\(\s*([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)\s*\)/);return e?{l:parseFloat(e[1]),c:parseFloat(e[2]),h:parseFloat(e[3])}:null}static parseColorMix(t){const e=t.match(/color-mix\(\s*in\s+oklch\s*,\s*([^,]+),\s*([^)]+)\s*\)/);if(!e)return null;const[,r,s]=e,o=t=>{const e=t.match(/(.+?)\s+(\d+)%/);return e?{color:e[1].trim(),percentage:parseFloat(e[2])}:{color:t.trim(),percentage:50}};return{color1:o(r),color2:o(s)}}static resolveCSSVariable(t){const e=t.match(/var\(\s*([^,)]+)(?:\s*,\s*([^)]+))?\s*\)/);if(!e)return null;const[,r,s]=e;return getComputedStyle(document.documentElement).getPropertyValue(r.trim())||s||null}static getBaseColors(){const t=new Map,e=getComputedStyle(document.documentElement),r=["--color-primary","--color-secondary","--color-tertiary","--color-neutral","--color-success","--color-attention","--color-error","--color-promotion"];for(const s of r){const r=e.getPropertyValue(s);if(r&&this.containsOklch(r)){const e=this.parseSimpleOklch(r);e&&t.set(s,e)}}return t}}class r{static processRelativeColors(t){const r=new Map,s=e.getBaseColors();for(const[e,o]of t){const l=this.processProperty(e,o,s,t);l&&r.set(e,l)}return r}static processProperty(r,s,o,l){const c=e.parseRelativeOklch(s);if(c)return this.processRelativeColor(c,o,l);const i=e.parseSimpleOklch(s);if(i)return t.oklchToRgb(i.l,i.c,i.h);const a=e.parseColorMix(s);return a?this.processColorMix(a,o,l):null}static processRelativeColor(e,r,s){const o=this.resolveBaseColor(e.from,r,s);if(!o)return null;const l=t.applyRelativeTransform(o.l,o.c,o.h,e.lightness,e.chroma,e.hue);return t.oklchToRgb(l.l,l.c,l.h)}static resolveBaseColor(t,r,s){if(t.startsWith("var(")){const o=t.match(/var\(\s*([^,)]+)/)?.[1];if(!o)return null;if(r.has(o))return r.get(o);if(s.has(o)){const t=s.get(o),r=e.parseSimpleOklch(t);if(r)return r}const l=e.resolveCSSVariable(t);if(l){const t=e.parseSimpleOklch(l);if(t)return t}}return t.startsWith("oklch(")?e.parseSimpleOklch(t):null}static processColorMix(t,e,r){const s=this.resolveColorValue(t.color1.color,e,r),o=this.resolveColorValue(t.color2.color,e,r);if(!s||!o)return null;const l=t.color1.percentage/100,c=t.color2.percentage/100,i=l+c,a=l/i,n=c/i;return{r:Math.round(s.r*a+o.r*n),g:Math.round(s.g*a+o.g*n),b:Math.round(s.b*a+o.b*n)}}static resolveColorValue(r,s,o){if("red"===r)return{r:255,g:0,b:0};if("blue"===r)return{r:0,g:0,b:255};if("white"===r)return{r:255,g:255,b:255};if("black"===r)return{r:0,g:0,b:0};if(r.startsWith("var(")){const s=e.resolveCSSVariable(r);if(s){const r=e.parseSimpleOklch(s);if(r)return t.oklchToRgb(r.l,r.c,r.h)}}if(r.startsWith("oklch(")){const s=e.parseSimpleOklch(r);if(s)return t.oklchToRgb(s.l,s.c,s.h)}return null}static generateShadeVariants(e,r){const s=new Map,o={50:{l:"calc(1 - (1 - l) * 0.6)",c:"calc(c * 0.8)",h:"h",iterations:4},100:{l:"calc(1 - (1 - l) * 0.6)",c:"calc(c * 0.8)",h:"h",iterations:3},200:{l:"calc(1 - (1 - l) * 0.6)",c:"calc(c * 0.8)",h:"h",iterations:2},300:{l:"calc(1 - (1 - l) * 0.6)",c:"calc(c * 0.8)",h:"h",iterations:1},400:{l:"calc(1 - (1 - l) * 0.6)",c:"calc(c * 0.8)",h:"h",iterations:0},500:{l:"l",c:"c",h:"h"},600:{l:"calc(l * 0.8)",c:"calc(c * 1.1)",h:"h",iterations:0},700:{l:"calc(l * 0.8)",c:"calc(c * 1.1)",h:"h",iterations:1},800:{l:"calc(l * 0.8)",c:"calc(c * 1.1)",h:"h",iterations:2},900:{l:"calc(l * 0.8)",c:"calc(c * 1.1)",h:"h",iterations:3},950:{l:"calc(l * 0.8)",c:"calc(c * 1.1)",h:"h",iterations:4}};for(const[l,c]of Object.entries(o)){let o={...e};for(let e=0;e<=(c.iterations||0);e++)o=t.applyRelativeTransform(o.l,o.c,o.h,c.l,c.c,c.h);const i=t.oklchToRgb(o.l,o.c,o.h);s.set(`--color-${r}-${l}`,i)}return s}}const s=new class{constructor(){this.version="1.0.0",this.isPolyfilled=!1,this.supported=this.checkNativeSupport(),this.initialized=!1,this.rgbFallbacks=new Map,this.refresh=this.refresh.bind(this),this.handleMutation=this.handleMutation.bind(this)}checkNativeSupport(){if("undefined"==typeof CSS||!CSS.supports)return!1;try{return CSS.supports("color","oklch(0.7 0.15 250)")&&CSS.supports("color","oklch(from red l c h)")}catch(t){return!1}}init(){this.initialized||(this.supported||(this.isPolyfilled=!0,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>this.activate())):this.activate()),this.initialized=!0)}activate(){try{this.processOklchColors(),this.setupMutationObserver()}catch(t){}}processOklchColors(){const t=e.extractOklchProperties();if(0===t.size)return;const s=r.processRelativeColors(t);this.generateBaseColorShades(s),this.applyRgbFallbacks(s)}generateBaseColorShades(t){const s=e.getBaseColors();for(const[e,o]of s){const s=e.replace("--color-",""),l=r.generateShadeVariants(o,s);for(const[e,r]of l)t.set(e,r)}}applyRgbFallbacks(t){const e=document.documentElement;for(const[r,s]of t)if(s&&"object"==typeof s&&"r"in s){const t=`rgb(${s.r}, ${s.g}, ${s.b})`;e.style.setProperty(r,t),this.rgbFallbacks.set(r,t)}}setupMutationObserver(){"undefined"!=typeof MutationObserver&&new MutationObserver((t=>{let e=!1;for(const r of t){if("attributes"===r.type&&"style"===r.attributeName){e=!0;break}if("childList"===r.type&&(r.addedNodes.length>0||r.removedNodes.length>0))for(const t of r.addedNodes)if(t.nodeType===Node.ELEMENT_NODE&&("STYLE"===t.tagName||"LINK"===t.tagName)){e=!0;break}}e&&(clearTimeout(this.refreshTimeout),this.refreshTimeout=setTimeout((()=>this.refresh()),100))})).observe(document.documentElement,{attributes:!0,attributeFilter:["style"],childList:!0,subtree:!0})}refresh(){this.isPolyfilled&&this.processOklchColors()}handleMutation(){this.refresh()}getStatus(){return{version:this.version,supported:this.supported,isPolyfilled:this.isPolyfilled,initialized:this.initialized,fallbackCount:this.rgbFallbacks.size}}convertColor(e){return t.parseOklchToRgb(e)}};"undefined"!=typeof window&&(window.AltitudeOklchPolyfill=s),s.init()}()}();